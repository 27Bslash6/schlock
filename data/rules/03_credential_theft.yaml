# Category: Credential Theft
# Risk Levels: BLOCKED
# Description: Commands that expose credentials and sensitive data

rules:
  - name: credential_exposure
    description: Exposing credentials is a security breach
    risk_level: BLOCKED
    patterns: ['cat\s+.{0,200}\.env', 'cat\s+.{0,200}id_rsa', 'echo.{0,200}password']
    alternatives: ["Use secure secret management"]

  - name: extended_credential_exposure
    description: Accessing additional credential files beyond .env and id_rsa
    risk_level: BLOCKED
    patterns: ['cat\s+.{0,200}\.aws/(credentials|config)', 'cat\s+.{0,200}\.ssh/(config|known_hosts|authorized_keys)', 'cat\s+.{0,200}\.npmrc', 'cat\s+.{0,200}\.netrc', 'cat\s+.{0,200}\.docker/config', 'cat\s+.{0,200}\.kube/config', 'cat\s+.{0,200}\.git-credentials', 'cat\s+.{0,200}\.pypirc', 'echo.{0,200}(AWS_SECRET|API_KEY|TOKEN|PASSWORD|PRIVATE_KEY)', 'printf.{0,200}(AWS_SECRET|API_KEY|TOKEN|PASSWORD|PRIVATE_KEY)']
    alternatives: ["Use proper secret management tools", "Never expose credentials"]

  - name: hardcoded_secrets
    description: Prevent hardcoding secrets
    risk_level: BLOCKED
    patterns: ['export\s+AWS_SECRET', 'export\s+.{0,100}_KEY=', 'export\s+.{0,100}_TOKEN=', "echo.{0,200}['\"].{0,100}key.{0,100}['\"]\\s*>"]
    alternatives: ["Use environment files", "Use secrets manager", "Use vault"]
